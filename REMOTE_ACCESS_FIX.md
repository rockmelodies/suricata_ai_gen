# ğŸ”§ è¿œç¨‹è®¿é—®é—®é¢˜ä¿®å¤æŒ‡å—

## ğŸ“‹ é—®é¢˜æè¿°

**ç—‡çŠ¶**ï¼š
- âœ… åœ¨Kaliæœ¬åœ°æµè§ˆå™¨è®¿é—® `http://localhost:8080` â†’ åŠŸèƒ½æ­£å¸¸
- âŒ åœ¨Windowsæµè§ˆå™¨è®¿é—® `http://Kali-IP:8080` â†’ é¡µé¢èƒ½æ‰“å¼€ï¼Œä½†åŠŸèƒ½æ— æ³•ä½¿ç”¨

**åŸå› åˆ†æ**ï¼š

```
Windowsæµè§ˆå™¨è®¿é—®: http://192.168.1.100:8080
  â†“
é¡µé¢åŠ è½½æˆåŠŸï¼Œä½†JavaScriptå°è¯•è¯·æ±‚:
  â†“
http://localhost:5000/api  âŒ é”™è¯¯ï¼è®¿é—®çš„æ˜¯Windowsæœ¬åœ°çš„5000ç«¯å£
  â†“
åº”è¯¥è¯·æ±‚: http://192.168.1.100:5000/api  âœ… æ­£ç¡®ï¼
```

## âœ… è§£å†³æ–¹æ¡ˆï¼ˆå·²å®Œæˆï¼‰

æˆ‘å·²ç»å®Œæˆäº†ä»¥ä¸‹ä¿®å¤ï¼š

### 1. **å‰ç«¯è‡ªåŠ¨æ£€æµ‹APIåœ°å€** âœ…

**ä¿®æ”¹æ–‡ä»¶**: `frontend/index.html`

**å…³é”®æ”¹åŠ¨**ï¼š
```javascript
// å…¨å±€å‡½æ•°ï¼šè‡ªåŠ¨è·å–APIåœ°å€
function getApiBaseUrl() {
    // ä¼˜å…ˆä½¿ç”¨æ‰‹åŠ¨é…ç½®
    if (window.API_BASE_URL) {
        return window.API_BASE_URL;
    }
    
    // è‡ªåŠ¨æ£€æµ‹ï¼šä½¿ç”¨å½“å‰é¡µé¢çš„host
    const protocol = window.location.protocol;
    const hostname = window.location.hostname;  // å…³é”®ï¼ä¼šè‡ªåŠ¨è·å–å®é™…è®¿é—®çš„IP
    const apiPort = '5000';
    
    return `${protocol}//${hostname}:${apiPort}/api`;
}
```

**æ•ˆæœ**ï¼š
- Kaliæœ¬åœ°è®¿é—® `http://localhost:8080` â†’ API: `http://localhost:5000/api`
- Windowsè¿œç¨‹è®¿é—® `http://192.168.1.100:8080` â†’ API: `http://192.168.1.100:5000/api`

### 2. **å‰ç«¯ç›‘å¬æ‰€æœ‰æ¥å£** âœ…

**ä¿®æ”¹æ–‡ä»¶**: `start_frontend.sh` å’Œ `start_frontend.bat`

**æ”¹åŠ¨**ï¼š
```bash
# ä¹‹å‰ï¼ˆåªç›‘å¬localhostï¼‰
python3 -m http.server 8080

# ç°åœ¨ï¼ˆç›‘å¬æ‰€æœ‰æ¥å£ï¼Œå…è®¸è¿œç¨‹è®¿é—®ï¼‰
python3 -m http.server 8080 --bind 0.0.0.0
```

### 3. **åç«¯ç›‘å¬æ‰€æœ‰æ¥å£** âœ…

**æ–‡ä»¶**: `backend/app.py`ï¼ˆå·²ç»æ˜¯æ­£ç¡®çš„ï¼‰

```python
if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)  # âœ… æ­£ç¡®
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### åœ¨Kaliæœºå™¨ä¸Šæ“ä½œï¼š

#### æ­¥éª¤1ï¼šæ›´æ–°ä»£ç 

å¦‚æœä½ å·²ç»åœ¨è¿è¡ŒæœåŠ¡ï¼Œå…ˆåœæ­¢ï¼š

```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
./stop_all.sh

# æˆ–æ‰‹åŠ¨åœæ­¢
killall python3
```

#### æ­¥éª¤2ï¼šé‡æ–°å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
chmod +x start_all.sh
./start_all.sh

# æ–¹å¼2ï¼šåˆ†åˆ«å¯åŠ¨
chmod +x start_backend.sh start_frontend.sh
./start_backend.sh &
./start_frontend.sh &
```

#### æ­¥éª¤3ï¼šæ£€æŸ¥ç«¯å£ç›‘å¬

```bash
# æ£€æŸ¥æ˜¯å¦ç›‘å¬åœ¨0.0.0.0
netstat -tlnp | grep -E ":(5000|8080)"
```

**æ­£ç¡®çš„è¾“å‡ºåº”è¯¥æ˜¯**ï¼š
```
tcp    0.0.0.0:5000    0.0.0.0:*    LISTEN    12345/python3
tcp    0.0.0.0:8080    0.0.0.0:*    LISTEN    12346/python3
```

**å¦‚æœçœ‹åˆ°çš„æ˜¯ `127.0.0.1:5000` æˆ– `127.0.0.1:8080`ï¼Œè¯´æ˜æ²¡æœ‰ç›‘å¬æ‰€æœ‰æ¥å£**

#### æ­¥éª¤4ï¼šé…ç½®é˜²ç«å¢™

```bash
# Kali/Debian/Ubuntu (UFW)
sudo ufw allow 5000
sudo ufw allow 8080
sudo ufw status

# æˆ–å…³é—­é˜²ç«å¢™ï¼ˆä»…æµ‹è¯•ç”¨ï¼‰
sudo ufw disable

# CentOS/RHEL (Firewalld)
sudo firewall-cmd --permanent --add-port=5000/tcp
sudo firewall-cmd --permanent --add-port=8080/tcp
sudo firewall-cmd --reload
```

#### æ­¥éª¤5ï¼šè·å–Kali IPåœ°å€

```bash
ip addr show | grep "inet " | grep -v "127.0.0.1"
# æˆ–
ifconfig | grep "inet " | grep -v "127.0.0.1"
```

å‡è®¾IPæ˜¯ï¼š`192.168.1.100`

### åœ¨Windowsæœºå™¨ä¸Šæµ‹è¯•ï¼š

#### æ­¥éª¤1ï¼šè®¿é—®å‰ç«¯é¡µé¢

æµè§ˆå™¨æ‰“å¼€ï¼š`http://192.168.1.100:8080`

#### æ­¥éª¤2ï¼šæ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰

**æ£€æŸ¥Consoleæ ‡ç­¾**ï¼š

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
[APIé…ç½®] è‡ªåŠ¨æ£€æµ‹: {
    protocol: "http:",
    hostname: "192.168.1.100",
    apiUrl: "http://192.168.1.100:5000/api"
}
```

**âŒ å¦‚æœçœ‹åˆ° `hostname: "localhost"`ï¼Œè¯´æ˜ï¼š**
1. æµè§ˆå™¨ç¼“å­˜æœªæ¸…é™¤
2. ä»£ç æœªæ›´æ–°

**âœ… å¦‚æœçœ‹åˆ° `hostname: "192.168.1.100"`ï¼Œè¯´æ˜é…ç½®æ­£ç¡®**

#### æ­¥éª¤3ï¼šæµ‹è¯•åŠŸèƒ½

1. å¡«å†™æ¼æ´ä¿¡æ¯ï¼ˆéšä¾¿å¡«ä¸€ä¸ªï¼‰
2. ç‚¹å‡»"AIç”Ÿæˆè§„åˆ™"æŒ‰é’®
3. åˆ‡æ¢åˆ°**Networkæ ‡ç­¾**
4. æŸ¥çœ‹APIè¯·æ±‚

**åº”è¯¥çœ‹åˆ°**ï¼š
```
Request URL: http://192.168.1.100:5000/api/rules/generate
Method: POST
Status: 200 OK (æˆ–å…¶ä»–æ­£å¸¸å“åº”)
```

**âŒ å¦‚æœçœ‹åˆ° `Request URL: http://localhost:5000/...`ï¼Œè¯´æ˜é—®é¢˜æœªä¿®å¤**

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: å‰ç«¯é¡µé¢æ— æ³•æ‰“å¼€

**æ£€æŸ¥**ï¼š
```bash
# Kaliä¸Š
netstat -tlnp | grep :8080
```

**å¦‚æœæ²¡æœ‰è¾“å‡º**ï¼š
- å‰ç«¯æœåŠ¡æœªå¯åŠ¨ï¼Œè¿è¡Œ `./start_frontend.sh`

**å¦‚æœæ˜¾ç¤º `127.0.0.1:8080`**ï¼š
- éœ€è¦åŠ  `--bind 0.0.0.0` å‚æ•°

### é—®é¢˜2: APIè¯·æ±‚å¤±è´¥ (ERR_CONNECTION_REFUSED)

**æ£€æŸ¥åç«¯**ï¼š
```bash
# Kaliä¸Š
curl http://localhost:5000/api/health
```

**å¦‚æœå¤±è´¥**ï¼š
- åç«¯æœªå¯åŠ¨ï¼Œè¿è¡Œ `./start_backend.sh`

**æ£€æŸ¥é˜²ç«å¢™**ï¼š
```bash
# Kaliä¸Š
sudo ufw status
```

**ä»Windowsæµ‹è¯•è¿æ¥**ï¼š
```powershell
# Windows PowerShell
Test-NetConnection -ComputerName 192.168.1.100 -Port 5000
Test-NetConnection -ComputerName 192.168.1.100 -Port 8080
```

### é—®é¢˜3: APIåœ°å€ä»ç„¶æ˜¯localhost

**æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**ï¼š

1. æŒ‰ `Ctrl+Shift+Delete`
2. é€‰æ‹©"æ¸…é™¤ç¼“å­˜çš„å›¾ç‰‡å’Œæ–‡ä»¶"
3. ç‚¹å‡»"æ¸…é™¤æ•°æ®"
4. å¼ºåˆ¶åˆ·æ–°é¡µé¢ `Ctrl+F5`

**æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼**ï¼š
- Chrome: `Ctrl+Shift+N`
- Firefox: `Ctrl+Shift+P`
- Edge: `Ctrl+Shift+N`

### é—®é¢˜4: CORSè·¨åŸŸé”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Access to XMLHttpRequest at 'http://192.168.1.100:5000/api/...' 
from origin 'http://192.168.1.100:8080' has been blocked by CORS policy
```

**è§£å†³æ–¹æ³•**ï¼š

æ£€æŸ¥ `backend/app.py` ç¡®ä¿æœ‰ï¼š
```python
from flask_cors import CORS

app = Flask(__name__)
CORS(app)  # å¿…é¡»æœ‰è¿™è¡Œ
```

å¦‚æœç¼ºå°‘ï¼Œå®‰è£…CORSï¼š
```bash
source .venv/bin/activate
pip install flask-cors
```

ç„¶åé‡å¯åç«¯æœåŠ¡ã€‚

## ğŸ§ª å®Œæ•´æµ‹è¯•æµç¨‹

è¿è¡Œè‡ªåŠ¨æµ‹è¯•è„šæœ¬ï¼š

```bash
chmod +x test_remote_access.sh
./test_remote_access.sh
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥ï¼š
1. âœ… ç½‘ç»œé…ç½®ï¼ˆIPåœ°å€ï¼‰
2. âœ… ç«¯å£ç›‘å¬çŠ¶æ€ï¼ˆæ˜¯å¦ç›‘å¬0.0.0.0ï¼‰
3. âœ… é˜²ç«å¢™çŠ¶æ€
4. âœ… APIè¿æ¥æµ‹è¯•
5. âœ… æä¾›è¯¦ç»†çš„æ’æŸ¥å»ºè®®

## ğŸ“Š éªŒè¯æˆåŠŸçš„æ ‡å¿—

### Kaliç«¯ï¼š

```bash
$ netstat -tlnp | grep -E ":(5000|8080)"
tcp    0.0.0.0:5000    0.0.0.0:*    LISTEN    12345/python3
tcp    0.0.0.0:8080    0.0.0.0:*    LISTEN    12346/python3

$ curl http://localhost:5000/api/health
{"status":"ok","timestamp":"2024-12-15T..."}
```

### Windowsç«¯ï¼š

**æµè§ˆå™¨Console**ï¼š
```
[APIé…ç½®] è‡ªåŠ¨æ£€æµ‹: {
    protocol: "http:",
    hostname: "192.168.1.100",  â† å¿…é¡»æ˜¯Kaliçš„IPï¼Œä¸æ˜¯localhost
    apiUrl: "http://192.168.1.100:5000/api"
}
```

**æµè§ˆå™¨Network**ï¼š
```
Request URL: http://192.168.1.100:5000/api/rules/generate  â† æ­£ç¡®
Status: 200 OK
```

**åŠŸèƒ½æµ‹è¯•**ï¼š
- âœ… ç‚¹å‡»"AIç”Ÿæˆè§„åˆ™"æœ‰å“åº”
- âœ… è§„åˆ™å†…å®¹æ˜¾ç¤ºåœ¨æ–‡æœ¬æ¡†ä¸­
- âœ… å¯ä»¥éªŒè¯è§„åˆ™
- âœ… å¯ä»¥ä¼˜åŒ–è§„åˆ™

## ğŸ“ å…³é”®æ–‡ä»¶ä¿®æ”¹æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | çŠ¶æ€ |
|------|---------|------|
| `frontend/index.html` | æ·»åŠ  `getApiBaseUrl()` å…¨å±€å‡½æ•° | âœ… å·²å®Œæˆ |
| `frontend/index.html` | æ·»åŠ console.logè°ƒè¯•è¾“å‡º | âœ… å·²å®Œæˆ |
| `start_frontend.sh` | æ·»åŠ  `--bind 0.0.0.0` | âœ… å·²å®Œæˆ |
| `start_frontend.bat` | æ·»åŠ  `--bind 0.0.0.0` | âœ… å·²å®Œæˆ |
| `backend/app.py` | ç›‘å¬ `0.0.0.0:5000` | âœ… åŸæœ¬æ­£ç¡® |
| `test_remote_access.sh` | æ–°å»ºæµ‹è¯•è„šæœ¬ | âœ… å·²åˆ›å»º |

## ğŸ¯ å¿«é€Ÿå‘½ä»¤

```bash
# === Kaliç«¯ ===

# 1. åœæ­¢æœåŠ¡
./stop_all.sh

# 2. å¯åŠ¨æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼Œæ”¯æŒè¿œç¨‹è®¿é—®ï¼‰
./start_all.sh

# 3. æ£€æŸ¥ç›‘å¬
netstat -tlnp | grep -E ":(5000|8080)"

# 4. å¼€æ”¾é˜²ç«å¢™
sudo ufw allow 5000
sudo ufw allow 8080

# 5. è·å–IP
ip addr show | grep "inet " | grep -v "127"

# 6. æµ‹è¯•API
curl http://localhost:5000/api/health

# 7. å®Œæ•´è¯Šæ–­
./test_remote_access.sh
```

```powershell
# === Windowsç«¯ ===

# 1. æµ‹è¯•ç«¯å£è¿é€šæ€§
Test-NetConnection -ComputerName 192.168.1.100 -Port 5000
Test-NetConnection -ComputerName 192.168.1.100 -Port 8080

# 2. è®¿é—®å‰ç«¯
# æµè§ˆå™¨æ‰“å¼€: http://192.168.1.100:8080

# 3. F12å¼€å‘è€…å·¥å…·
# - Consoleæ ‡ç­¾ï¼šæŸ¥çœ‹APIé…ç½®æ—¥å¿—
# - Networkæ ‡ç­¾ï¼šæŸ¥çœ‹APIè¯·æ±‚URL

# 4. æ¸…é™¤ç¼“å­˜
# Ctrl+Shift+Delete â†’ æ¸…é™¤ç¼“å­˜ â†’ Ctrl+F5å¼ºåˆ¶åˆ·æ–°
```

## ğŸ’¡ æŠ€æœ¯åŸç†

### é—®é¢˜çš„æ ¹æœ¬åŸå› 

åœ¨å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ä¸­ï¼Œå‰ç«¯JavaScriptè¿è¡Œåœ¨**å®¢æˆ·ç«¯æµè§ˆå™¨**ä¸­ï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨ä¸Šã€‚

**é”™è¯¯çš„æ€è·¯**ï¼š
```
ç”¨æˆ·è®¿é—®: http://192.168.1.100:8080
å‰ç«¯JSä»£ç : apiBaseUrl = 'http://localhost:5000/api'
           â†“
æµè§ˆå™¨å°è¯•è¿æ¥: http://localhost:5000
           â†“
å®é™…è¿æ¥çš„æ˜¯: Windowsæœ¬åœ°çš„5000ç«¯å£ âŒ
```

**æ­£ç¡®çš„å®ç°**ï¼š
```javascript
// åŠ¨æ€è·å–å½“å‰è®¿é—®çš„host
const hostname = window.location.hostname; // 192.168.1.100
const apiUrl = `http://${hostname}:5000/api`;
           â†“
æµè§ˆå™¨è¿æ¥: http://192.168.1.100:5000
           â†“
æˆåŠŸè¿æ¥åˆ°: Kaliçš„5000ç«¯å£ âœ…
```

### ç›‘å¬åœ°å€çš„åŒºåˆ«

| ç›‘å¬åœ°å€ | å«ä¹‰ | å¤–éƒ¨èƒ½å¦è®¿é—® |
|---------|------|-------------|
| `127.0.0.1:5000` | åªç›‘å¬æœ¬åœ°å›ç¯ | âŒ ä¸èƒ½ |
| `localhost:5000` | åŒä¸Š | âŒ ä¸èƒ½ |
| `0.0.0.0:5000` | ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ | âœ… å¯ä»¥ |
| `192.168.1.100:5000` | åªç›‘å¬ç‰¹å®šIP | âš ï¸ åªèƒ½é€šè¿‡è¿™ä¸ªIP |

**æ¨èä½¿ç”¨ `0.0.0.0`ï¼Œè¿™æ ·æ— è®ºé€šè¿‡å“ªä¸ªIPè®¿é—®éƒ½å¯ä»¥**ã€‚

## ğŸ”’ å®‰å…¨æç¤º

å¦‚æœéƒ¨ç½²åœ¨å…¬ç½‘æœåŠ¡å™¨ï¼Œå»ºè®®ï¼š

1. **ä½¿ç”¨Nginxåå‘ä»£ç†**ï¼ˆå‚è€ƒ DEPLOYMENT.mdï¼‰
2. **æ·»åŠ è®¤è¯æœºåˆ¶**
3. **é…ç½®HTTPS**
4. **é™åˆ¶è®¿é—®IP**

å†…ç½‘æµ‹è¯•å¯ä»¥ç›´æ¥ä½¿ç”¨å½“å‰é…ç½®ã€‚

---

**ç°åœ¨æ‚¨å¯ä»¥ä»Windowsè®¿é—®Kaliéƒ¨ç½²çš„æœåŠ¡äº†ï¼** ğŸ‰
